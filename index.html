<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Test Pi Platby</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f0f0f0; }
    button { padding: 1em; font-size: 1.2em; }
  </style>
</head>
<body>
  <h1>Test Pi Platby</h1>
  <button onclick="spustitPlatbu()">Zaplatit 0.5 Pi</button>

  <script>
    if (window.Pi) {
      Pi.init({
        version: "2.0",
        sandbox: true
      });

      Pi.authenticate(['payments'], function (onIncompletePaymentFound) {})
        .then(function (auth) {
          console.log("Pi uživatel přihlášen:", auth.user.uid);
        })
        .catch(function (error) {
          console.error("Chyba při autentizaci:", error);
        });

      function spustitPlatbu() {
        Pi.createPayment(
          {
            amount: 0.5,
            memo: "Testovací platba",
            metadata: { test: true }
          },
          {
            onReadyForServerApproval: function (paymentId) {
              console.log("Schvaluji platbu:", paymentId);
              Pi.approvePayment(paymentId);
            },
            onReadyForServerCompletion: function (paymentId, txid) {
              console.log("Platba hotová:", paymentId, txid);
              Pi.completePayment(paymentId, txid);
              alert("Platba úspěšná!");
            },
            onCancel: function (paymentId) {
              console.log("Platba zrušena:", paymentId);
            },
            onError: function (error, paymentId) {
              console.error("Chyba platby:", error);
            }
          }
        );
      }
    } else {
      alert("Pi SDK není načteno.");
    }
  </script>
</body>
</html>
